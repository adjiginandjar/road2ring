<!DOCTYPE html>
<html layout:decorate="~{rtms/layout}">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/rtms/css/fragment/tab-menu.css">
    <link rel="stylesheet" href="/rtms/css/rtms-form.css" />
    <title>Ubah Profil</title>
</head>

<body>
    <div layout:fragment="header">
        <div
            th:replace="rtms/component/breadcrumb::template (data = ${ {{'Beranda','/trip/rtms', ''},{' Profil','/user/profile/rtms', 'active'}} } )">
        </div>
    </div>
    <div layout:fragment="content">
        <div class="content-inner">
            <div class="bg-white">
                <form class="main-form profil-form" method="POST" th:action="@{'/user/profile/rtms/submit'}" role="form">
                    <input type="hidden" name="id" th:value="${response.object.id}">
                    <div class="box-body">
                        <div class="form-group">
                            <div class="pro-pic profile-picture" style="width: 88px; height: 88px;" 
                                th:styleappend="${response.object.picture != null} ? 'background-image:url('+${response.object.picture}+');border-radius:50%;'">
                                <input type="url" id="hidden-profile-picture" name="picture"
                                    th:value="${response.object.picture}" style="opacity: 0; position: absolute;"/>
                                <input type="file" id="profile-picture" style="display: none;"/>
                                <img class="input-icon" style="cursor: pointer;" 
                                src="/rtms/assets/icon-cam.png" alt="" />
                                <div class="wrap_profile-picture collapse" style="
                                position: absolute;
                                margin: auto;
                                width: 90%;
                                top: 35px;
                                left: 5px;">
                                    <div class="progress">
                                        <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar" aria-valuenow="50"
                                            aria-valuemin="0" aria-valuemax="100">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        <div class="form-group">
                            <label>Nama Lengkap</label>
                            <input type="text" class="form-control input-counter"
                                th:value="${response.object.fullName}"
                                name="fullName" placeholder="Masukkan Nama" maxlength="50" autocomplete="off" required>
                            <span class="help-block">50/50</span>
                        </div>
                        <div class="form-group">
                            <label>Tanggal Lahir</label>
                            <div class="input-date">
                                <input  type="text" class="form-control" id="datepicker" 
                                    th:value="${response.object.birthday != null && response.object.birthday != '' ? #dates.format(response.object.birthday, 'MM/dd/yyyy') : ''}" 
                                    name="birthday" placeholder="Pilih Tanggal" autocomplete="off" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Nomor Telepon</label>
                            <input  type="number" class="form-control"
                                th:value="${response.object.phoneNumber}"
                                name="phoneNumber" placeholder="Masukkan No Telepon" required>
                        </div>
                        <div class="form-group">
                            <label>Golongan Darah</label>
                            <select class="form-control" name="bloodType" id="">
                                <option value="">Pilih Golongan Darah</option>
                                <option value="A" th:selected="${response.object.bloodType == 'A'}">A</option>
                                <option value="B" th:selected="${response.object.bloodType == 'B'}">B</option>
                                <option value="O" th:selected="${response.object.bloodType == 'O'}">O</option>
                                <option value="AB" th:selected="${response.object.bloodType == 'AB'}">AB</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="text" class="form-control"
                                th:value="${response.object.email}" 
                                name="" disabled required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input th:value="${'response.object.password'}" type="password" class="form-control"
                                name="" disabled required>
                            <a href="/user/profile/rtms/edit-password" class="help-block">edit password</a>
                        </div>                        
                        <div class="form-group">
                            <label>No KTP</label>
                            <input type="text" class="form-control"
                                th:value="${response.object.userIdentitiyNumber}" 
                                name="userIdentitiyNumber" placeholder="Masukkan No KTP" required>
                        </div>
                        <div class="form-group">
                            <label>Foto KTP</label>
                            <input type="url" id="hidden-cover-landscape" style="opacity: 0; position: absolute;"
                                name="userIdentityPicture" th:value="${response.object.userIdentityPicture}" required />
                            <input type="file" id="cover-landscape" style="display: none;" />
                            <div class="input-icon">
                                <input type="text" class="form-control mask-file" value="Upload gambar"
                                    readonly />
                            </div>
                            <span class="help-block">Maks. 150kb</span>
                            <div
                                th:replace="rtms/component/uploadSuccessBox::template(section = ${'cover-landscape'}, urlImageField=${response.object.userIdentityPicture})">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>No SIM C</label>
                            <input type="text" class="form-control"
                                th:value="${response.object.driverLicenseNumber}" 
                                name="driverLicenseNumber" placeholder="Masukkan No SIM C" required>
                        </div>
                        <div class="form-group">
                            <label>Foto SIM C</label>
                            <input type="url" id="hidden-cover-potrait" name="driverLicensePicture"
                                th:value="${response.object.driverLicensePicture}" style="opacity: 0; position: absolute;"
                                required />
                            <input type="file" id="cover-potrait" style="display: none;" />
                            <div class="input-icon">
                                <input type="text" class="form-control mask-file" value="Upload gambar"
                                    readonly />
                            </div>
                            <span class="help-block">Maks. 150kb</span>
                            <div
                                th:replace="rtms/component/uploadSuccessBox::template(section = ${'cover-potrait'}, urlImageField=${response.object.driverLicensePicture})">
                            </div>
                        </div>
                    </div>
                    <div class="box-footer btn-multi">
                        <button type="submit" class="btn btn-primary">Simpan</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div layout:fragment="footer-js">
        <script src="/rtms/js/jquery.html5uploader.min.js"></script>
        <script src="/rtms/js/upload.js"></script>

        <script>
            $(function () {
                $('#datepicker').datepicker({
                    format: 'mm/dd/yyyy',
                });
                upload_trip("/api/trip/upload_trip", "cover-landscape", "#cover-landscape", "#hidden-cover-landscape", 640, 640, "landscape");
                upload_trip("/api/trip/upload_trip", "cover-potrait", "#cover-potrait", "#hidden-cover-potrait", 640, 640, "potrait");
                upload_profile_picture("/api/trip/upload_trip", "profile-picture", "#profile-picture", "#hidden-profile-picture", 640, 640, "potrait");

                $('.input-icon').on("click touchend", function () {
                    $(this).prev().click();
                    return false;
                });
                $(".input-counter").each(function () {
                    var maxlength = $(this).attr("maxlength");
                    var currentLength = $(this).val().length;
                    $(this).next().html(maxlength - currentLength + '/50');
                })
                $(".input-counter").keyup(function (event) {
                    var maxlength = $(this).attr("maxlength");
                    var currentLength = $(this).val().length;
                    if (currentLength >= maxlength) {
                        $(this).next().html('0');
                        console.log("You have reached the maximum number of characters.");
                    } else {
                        $(this).next().html(maxlength - currentLength + '/50');
                        //console.log(maxlength - currentLength + " chars left");
                    }
                });

            });

        </script>
    </div>
</body>

</html>